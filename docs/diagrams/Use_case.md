# Диаграмма вариантов использования

![Диаграмма вариантов использования](diagrams/Use_Case.png)

---

# Глоссарий

| Термин | Определение |
|:--|:--|
| Пользователь | Человек, использующий веб-приложение |
| Гость | Пользователь без регистрации/входа |
| Зарегистрированный пользователь | Пользователь с учётной записью (этап 2) |
| Биржа | Криптобиржа с деривативами (OKX, Bybit, Binance Futures, MEXC и др.) |
| Токен (base) | Базовый актив (BTC, ETH, SOL и т.п.) |
| Контракт | Фьючерсный инструмент (PERP/квартальный; USDT-M/USD-M/coin-M) |
| Спред | Разница цен одного и того же актива между двумя биржами (абсолют и %) |
| Избранное | Список токенов/контрактов, сохранённых пользователем (этап 2) |
| Биржевые API | Публичные REST/WebSocket интерфейсы, источник данных |

---

# Поток событий

## Содержание
1 [Актёры](#actors)  
2 [Варианты использования](#use_cases)  
2.1 [Поиск токена](#uc_search)  
2.2 [Просмотр спредов](#uc_spreads)  
2.3 [Просмотр биржи](#uc_exchange)  
2.4 [Фильтрация и сортировка](#uc_filter)  
2.5 [Просмотр статусов депозитов/выводов](#uc_status)  
2.6 [Добавить токен в избранное](#uc_favadd) *(этап 2)*  
2.7 [Удалить токен из избранного](#uc_favremove) *(этап 2)*  
2.8 [Экспорт таблицы (CSV)](#uc_export) *(этап 2)*  
2.9 [Вход/Регистрация](#uc_login) *(этап 2)*  
2.10 [Выход](#uc_logout) *(этап 2)*  

---

<a name="actors"/>

## 1 Актёры

| Актёр | Описание |
|:--|:--|
| **Гость** | Просматривает цены/спреды без авторизации |
| **Зарегистрированный пользователь** | Может работать с избранным и экспортом |
| **Биржевые API** | Источник рыночных и справочных данных (REST/WS) |

---

<a name="use_cases"/>

## 2 Варианты использования

<a name="uc_search"/>

### 2.1 Поиск токена

**Описание.** Пользователь вводит base (например, `SOL`) и получает список контрактов на поддерживаемых биржах с актуальными ценами.  
**Предусловия.** Интернет-соединение.  
**Основной поток.**  
1. Пользователь вводит строку поиска и подтверждает.  
2. Система нормализует запрос (регистр, синонимы тикера).  
3. Система запрашивает данные у биржевых API и/или из локального кэша.  
4. Формируется таблица: **Биржа | Контракт | Цена (Last/Mark) | 24h Δ**.  
5. Таблица отображается пользователю.  

**Альтернативы.**  
А1. *Ничего не найдено* → показать пустое состояние и подсказки.  

**Ошибки.**  
Е1. *Таймаут/ошибка API* → уведомление + кнопка «Повторить».  

**Постусловия.** Результаты доступны для [фильтрации/сортировки](#uc_filter) и [просмотра спредов](#uc_spreads).

---

<a name="uc_spreads"/>

### 2.2 Просмотр спредов

**Описание.** Отображение межбиржевых спредов для выбранного токена/набора контрактов.  
**Предусловия.** Выполнен [Поиск токена](#uc_search) или выбран токен из преднастроек.  
**Основной поток.**  
1. Пользователь открывает вкладку «Спреды».  
2. Система получает актуальные котировки по WS (с REST-фоллбеком).  
3. Рассчитываются спреды: абсолют и % к опорной бирже/цене.  
4. Таблица спредов рендерится и обновляется в реальном времени.  
5. Пользователь сортирует по максимальному спреду.  

**Альтернативы.**  
А1. *Часть бирж не вернула данные* → ячейки `N/A`.  

**Ошибки.**  
Е1. *Разрыв WS* → переключение на REST + статус «Переподключение…».  

**Постусловия.** Данные можно [экспортировать](#uc_export) или добавить в [избранное](#uc_favadd).

---

<a name="uc_exchange"/>

### 2.3 Просмотр биржи

**Описание.** Список всех фьючерсных контрактов выбранной биржи с ценами.  
**Предусловия.** Пользователь выбрал биржу.  
**Основной поток.**  
1. Система загружает список контрактов и последние цены.  
2. Отображается таблица: **Контракт | Цена | 24h Δ | Тип | Маржа**.  
3. Пользователь может перейти к спредам по выбранному контракту/токену.  

**Ошибки.**  
Е1. *Биржа недоступна/ограничена* → показать предупреждение.

---

<a name="uc_filter"/>

### 2.4 Фильтрация и сортировка

**Описание.** Ограничение результата по типу контракта и марже; сортировка по цене/спреду/24h Δ.  
**Предусловия.** Загружена таблица из [Поиска токена](#uc_search) или [Просмотра биржи](#uc_exchange).  
**Основной поток.**  
1. Пользователь задаёт фильтры (PERP/квартал; USDT-M/USD-M/coin-M) и критерий сортировки.  
2. Система применяет фильтры локально (без лишних сетевых запросов, если возможно).  
3. Таблица обновляется.  

---

<a name="uc_status"/>

### 2.5 Просмотр статусов депозитов/выводов

**Описание.** Показ статусов `Deposit/Withdraw` по активу на каждой бирже (если доступно).  
**Предусловия.** Выбран токен/биржи.  
**Основной поток.**  
1. Система обращается к эндпоинтам метаданных бирж.  
2. Отображает бейджи: **Депозит** ✅/❌, **Вывод** ✅/❌.  

**Ошибки.**  
Е1. *Эндпоинт недоступен* → статус «Неизвестно».

---

<a name="uc_favadd"/>

### 2.6 Добавить токен в избранное *(этап 2)*

**Описание.** Сохранение токена/контракта для быстрого доступа.  
**Предусловия.** Пользователь авторизован.  
**Основной поток.**  
1. Нажатие «☆ Добавить в избранное».  
2. Система сохраняет запись в профиле пользователя.  
3. UI показывает подтверждение, список «Избранное» обновляется.  

**Альтернативы.**  
А1. *Уже в избранном* → сообщение «Уже добавлен».

---

<a name="uc_favremove"/>

### 2.7 Удалить токен из избранного *(этап 2)*

**Предусловия.** Пользователь авторизован, токен есть в избранном.  
**Основной поток.**  
1. Нажатие «★ Удалить».  
2. Система удаляет запись из профиля.  
3. Список «Избранное» обновляется.  

---

<a name="uc_export"/>

### 2.8 Экспорт таблицы (CSV) *(этап 2)*

**Описание.** Выгрузка текущего представления таблицы.  
**Предусловия.** Таблица сформирована.  
**Основной поток.**  
1. Пользователь выбирает «Экспорт CSV».  
2. Система формирует CSV с текущими колонками/фильтрами/сортировкой.  
3. Браузер скачивает файл.  

---

<a name="uc_login"/>

### 2.9 Вход/Регистрация *(этап 2)*

**Описание.** Создание/использование учётной записи.  
**Предусловия.** Пользователь открывает модальное окно входа/регистрации.  
**Основной поток.**  
1. Ввод данных и подтверждение.  
2. Система создаёт профиль или извлекает существующий.  
3. Приложение переключается в режим «Авторизован».  

**Альтернативы.**  
А1. *Отмена* → модальное окно закрывается без изменений.  

**Ошибки.**  
Е1. *Неверные данные* → сообщение об ошибке; повтор ввода.

---

<a name="uc_logout"/>

### 2.10 Выход *(этап 2)*

**Предусловия.** Пользователь авторизован.  
**Основной поток.**  
1. Выбор «Выйти».  
2. Система очищает сессию и возвращает гостевой режим.  

---
