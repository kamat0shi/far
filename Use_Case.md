%%{init: {'theme':'neutral'}}%%
usecaseDiagram
title Futures Arbitrage Radar — Use Cases

actor "Гость" as Guest
actor "Зарегистрированный\nпользователь" as Reg
actor "Биржевые API\n(OKX/Bybit/…)" as ExAPI

rectangle "Futures Arbitrage Radar" {
  usecase "Поиск токена" as UC_Search
  usecase "Просмотр спредов" as UC_Spreads
  usecase "Просмотр биржи" as UC_Exchange
  usecase "Фильтрация/сортировка" as UC_Filter
  usecase "Просмотр статусов\nдепозитов/выводов" as UC_Status

  usecase "Добавить токен\nв избранное" as UC_FavAdd
  usecase "Удалить токен\nиз избранного" as UC_FavRemove
  usecase "Экспорт таблицы (CSV)" as UC_Export

  usecase "Вход/Регистрация" as UC_Login
  usecase "Выход" as UC_Logout
}

Guest --> UC_Search
Guest --> UC_Spreads
Guest --> UC_Exchange
Guest --> UC_Filter
Guest --> UC_Status

Reg --> UC_FavAdd
Reg --> UC_FavRemove
Reg --> UC_Export
Reg --> UC_Login
Reg --> UC_Logout

UC_Search <-- ExAPI
UC_Spreads <-- ExAPI
UC_Exchange <-- ExAPI
UC_Status <-- ExAPI

Глоссарий
Термин	Определение
Пользователь	Любой человек, использующий веб-приложение
Гость	Пользователь без регистрации/входа
Зарегистрированный пользователь	Пользователь с учётной записью (этап 2)
Токен (base)	Базовый актив (BTC, ETH, SOL и т.п.)
Контракт	Фьючерсный инструмент (PERP/квартальный; USDT-M/USD-M/coin-M)
Спред	Разница цен одного и того же актива между биржами
Биржевые API	Публичные REST/WebSocket интерфейсы бирж
Избранное	Пользовательский список токенов/контрактов для быстрого доступа
Поток событий
Содержание

1 Актёры

2 Варианты использования

2.1 Поиск токена

2.2 Просмотр спредов

2.3 Просмотр биржи

2.4 Фильтрация и сортировка

2.5 Просмотр статусов депозитов/выводов

2.6 Добавить токен в избранное

2.7 Удалить токен из избранного

2.8 Экспорт таблицы (CSV)

2.9 Вход/Регистрация

2.10 Выход

<a name="actors"/>
1 Актёры
Актёр	Описание
Гость	Просматривает токены/спреды без авторизации
Зарегистрированный пользователь	Может работать с избранным и экспортом
Биржевые API	Источник рыночных данных (цены, статусы, метаданные)
<a name="use_cases"/>
2 Варианты использования
<a name="uc_search"/>
2.1 Поиск токена

Описание. Пользователь вводит base (например, SOL) и получает все соответствующие контракты на поддерживаемых биржах.
Предусловия. Доступ к веб-приложению; соединение с интернетом.
Основной поток.

Пользователь вводит строку поиска и подтверждает.

Система нормализует запрос (регистр, синонимы тикера).

Система отправляет запросы к биржевым API и/или использует локальный кэш.

Система показывает таблицу: Биржа | Контракт | Цена (Last/Mark) | 24h Δ.

Вариант использования завершается.

Альтернативы/ошибки.
А1: Ничего не найдено → показать пустое состояние и подсказки.
Е1: Таймаут/ошибка API → показать уведомление и кнопку «Повторить».

Постусловия. Результаты доступны для дальнейшей сортировки/фильтрации.

<a name="uc_spreads"/>
2.2 Просмотр спредов

Описание. Отображение межбиржевых спредов для выбранного base/набора контрактов.
Предусловия. Есть результаты поиска или выбран преднастройкой список токенов.
Основной поток.

Пользователь открывает вкладку «Спреды».

Система получает актуальные котировки (WS/REST).

Система рассчитывает спреды (абсолютный и % к опорной бирже/цене).

Таблица спредов отображается и обновляется в реальном времени.

Пользователь может сортировать по максимальному спреду.

Вариант использования завершается.

Альтернативы/ошибки.
Е1: Нет данных по части бирж → пометить ячейки как «N/A».
Е2: Разрыв WS → фоллбек на REST и уведомление «пере-подключение».

Постусловия. Данные готовы для экспорта/добавления в избранное.

<a name="uc_exchange"/>
2.3 Просмотр биржи

Описание. Список всех доступных фьючерсных контрактов выбранной биржи.
Предусловия. Пользователь выбрал биржу из списка.
Основной поток.

Система загружает список контрактов биржи.

Отображает таблицу: Контракт | Цена | 24h Δ | Тип | Маржа.

Пользователь может перейти к спредам по конкретному контракту.

Вариант использования завершается.

Ошибки.
Е1: Биржа недоступна/ограничена по региону → показать предупреждение.

<a name="uc_filter"/>
2.4 Фильтрация и сортировка

Описание. Ограничение результата по типу (PERP/квартальный), марже (USDT-M/USD-M/coin-M), сортировка по цене/спреду/24h Δ.
Предусловия. Есть загруженная таблица.
Основной поток.

Пользователь настраивает фильтры/сортировку.

Система применяет их локально (без повторного запроса, если возможно).

Таблица обновляется.

Вариант использования завершается.

<a name="uc_status"/>
2.5 Просмотр статусов депозитов/выводов

Описание. Показ статусов Deposit/Withdraw по активу на каждой бирже (если доступно через публичные endpoints).
Предусловия. Выбран токен/биржи.
Основной поток.

Система запрашивает метаданные активов.

Отображает бейджи (✅/❌) у соответствующих ячеек.

Вариант использования завершается.

Ошибки.
Е1: Endpoint недоступен → статус «Неизвестно».

<a name="uc_favadd"/>
2.6 Добавить токен в избранное (этап 2)

Описание. Пользователь сохраняет токен/контракт в избранное.
Предусловия. Пользователь авторизован.
Основной поток.

Пользователь нажимает «☆ Добавить в избранное».

Система сохраняет сущность в профиле пользователя.

UI показывает подтверждение и обновляет список «Избранное».

Вариант использования завершается.

Альтернативы.
А1: Токен уже в избранном → показать сообщение «Уже добавлен».

<a name="uc_favremove"/>
2.7 Удалить токен из избранного (этап 2)

Основной поток.

Пользователь нажимает «★ Удалить».

Система удаляет сущность из профиля.

Список обновляется.

Вариант использования завершается.

<a name="uc_export"/>
2.8 Экспорт таблицы (CSV) (этап 2)

Основной поток.

Пользователь выбирает «Экспорт CSV».

Система формирует CSV текущего представления таблицы.

Браузер скачивает файл.

Вариант использования завершается.

<a name="uc_login"/>
2.9 Вход/Регистрация (этап 2)

Основной поток.

Пользователь открывает модальное окно входа/регистрации.

Вводит данные/подтверждает вход (или SSO — опционально).

Система создаёт профиль или извлекает существующий.

Вариант использования завершается.

Альтернативы/ошибки.
Е1: Неверные данные → показать ошибку и дать повторить.
А1: Отмена пользователем → закрыть модальное окно.

<a name="uc_logout"/>
2.10 Выход (этап 2)

Основной поток.

Пользователь выбирает «Выйти».

Система очищает сессию и возвращает к гостевому режиму.

Вариант использования завершается.
